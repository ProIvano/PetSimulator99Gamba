<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Casino</title>

<style>
body { background:#111; color:#fff; font-family:Arial,sans-serif; margin:0 }
h1 { text-align:center; margin-top:20px }
button,input,select { padding:6px; margin:4px }
.hidden { display:none }

#balanceBox {
  position:fixed;
  top:10px;
  right:10px;
  background:#222;
  padding:10px;
  border-radius:6px;
}

/* GAME AREA */
#games { text-align:center; margin-top:90px }

/* GRIDS */
.grid { display:grid; gap:10px; justify-content:center }
.cell,.block { width:70px; height:70px; background:#333; display:flex; align-items:center; justify-content:center; border-radius:6px; cursor:pointer; }

/* DRAW BIGGER */
.drawCell {
  width:95px; height:95px; background:#333; display:flex;
  flex-direction:column; align-items:center; justify-content:center;
  border-radius:8px;
}

.safe { background:green }
.fail { background:red }
.locked { background:#555; cursor:not-allowed }

.tower { display:flex; flex-direction:column-reverse; align-items:center }
.row { display:flex }

#toastBox {
  position:fixed; bottom:20px; left:50%; transform:translateX(-50%);
}
.toast { background:#222; padding:10px 20px; margin-top:6px; border-radius:6px }
.small { font-size:12px; opacity:0.8 }

/* RIGHT-SIDE MENU */
#menuBox {
  position:fixed; top:100px; right:10px; background:#222;
  padding:10px; border-radius:6px; display:flex;
  flex-direction:column; gap:6px; width:160px;
}
</style>
</head>

<body>

<h1>Mini Casino</h1>

<div id="balanceBox">
  <div id="balanceText">Balance: 100</div>
</div>

<!-- RIGHT SIDE MENU -->
<div id="menuBox">
  <button onclick="depositBalance()">Deposit Balance</button>
  <button onclick="withdrawBalance()">Withdraw Balance</button>
  <button onclick="earnFreeBalance()">Earn Free Balance</button>
</div>

<div id="games">
  Bet:
  <input id="betInput" type="number" value="10" min="1"><br><br>

  <button onclick="showGame('crash')">Crash</button>
  <button onclick="showGame('mines')">Mines</button>
  <button onclick="showGame('tower')">Tower</button>
  <button onclick="showGame('draw')">DRAW</button>

  <div id="options"></div>

  <div id="crash" class="hidden">
    <h3 id="crashMult">1.00x</h3>
    <button onclick="startCrash()">Start</button>
    <button onclick="cashoutCrash()">Cashout</button>
  </div>

  <div id="mines" class="hidden"></div>
  <div id="tower" class="hidden"></div>
  <div id="draw" class="hidden"></div>
</div>

<div id="toastBox"></div>

<script>
/* ================= CORE ================= */
let balance = 100;
const balanceText = document.getElementById("balanceText");
const toastBox = document.getElementById("toastBox");
const options = document.getElementById("options");

function formatNum(num){ return num.toLocaleString(); }
function updateBalance() { balanceText.innerText = "Balance: " + formatNum(balance); }
function toast(msg) {
  const t = document.createElement("div");
  t.className = "toast"; t.innerText = msg;
  toastBox.appendChild(t);
  setTimeout(()=>t.remove(),3000);
}

/* ================= RIGHT MENU ================= */
function depositBalance() {
  const msg = prompt("Enter your username and amount to deposit (Admin will approve):");
  if(msg) alert("Deposit request sent: " + msg);
}
function withdrawBalance() {
  const msg = prompt("Enter your username and amount to withdraw (Admin will approve):");
  if(msg) alert("Withdraw request sent: " + msg);
}
function earnFreeBalance() {
  alert("You will be redirected to YouTube. After returning, you get 5,000,000 balance!");
  window.open("https://www.youtube.com/@WeOwnToSlow","_blank");
  setTimeout(()=>{
    balance += 5000000;
    updateBalance();
    toast("You received " + formatNum(5000000) + " balance!");
  },2000);
}

/* ================= GAME SWITCH ================= */
function showGame(game){
  ["crash","mines","tower","draw"].forEach(id=>document.getElementById(id).classList.add("hidden"));
  document.getElementById(game).classList.remove("hidden");
  options.innerHTML="";

  if(game==="mines"){
    options.innerHTML = `
      Mines:
      <input id="mineCount" type="number" value="3" min="1" max="24">
      <button onclick="startMines()">Start</button>
      <button onclick="cashoutMines()">Cashout</button>`;
  }
  if(game==="tower"){
    options.innerHTML = `
      <select id="towerDiff">
        <option value="easy">EASY</option>
        <option value="medium">MEDIUM</option>
        <option value="hard">HARD</option>
      </select>
      <button onclick="startTower()">Start</button>
      <button onclick="cashoutTower()">Cashout</button>`;
  }
  if(game==="draw"){
    options.innerHTML = `
      <button onclick="startDraw()">Start DRAW</button>
      <button onclick="doubleAllDraw()">DOUBLE ALL</button>
      <button onclick="withdrawAllDraw()">Withdraw ALL</button>`;
  }
}

/* ================= SMOOTH CRASH ================= */
let crashBet=0, crashMult=1, crashPoint=0, crashStart=null, crashAnimation=null;

function getCrashPoint() {
  const r = Math.random();
  if (r < 0.7) return 1.2 + Math.random();
  if (r < 0.95) return 2 + Math.random()*2;
  return 4 + Math.random()*3;
}

function startCrash() {
  if(crashAnimation) return;
  crashBet = +betInput.value;
  if(crashBet > balance) return;
  balance -= crashBet; updateBalance();
  
  crashMult = 1.01;
  crashPoint = getCrashPoint();
  crashStart = null;

  function animate(timestamp) {
    if(!crashStart) crashStart = timestamp;
    const t = (timestamp - crashStart) / 1000; // seconds
    crashMult = 1 + 0.01*t + 0.02*t*t; // smooth acceleration
    crashMult = Math.min(crashMult, crashPoint);
    document.getElementById("crashMult").innerText = crashMult.toFixed(2) + "x";

    if(crashMult >= crashPoint){
      toast("You lost " + formatNum(crashBet));
      crashAnimation = null;
      return;
    }
    crashAnimation = requestAnimationFrame(animate);
  }

  crashAnimation = requestAnimationFrame(animate);
}

function cashoutCrash(){
  if(!crashAnimation) return;
  cancelAnimationFrame(crashAnimation);
  crashAnimation = null;
  const win = Math.floor(crashBet * crashMult);
  balance += win; updateBalance();
  toast("Crash win " + formatNum(win) + " at " + crashMult.toFixed(2) + "x");
}

/* ================= MINES ================= */
let minesState=null;
function startMines(){
  const bet=+betInput.value;
  const mines=+mineCount.value;
  if(bet>balance) return;
  balance-=bet; updateBalance();
  const bombs=new Set();
  while(bombs.size<mines) bombs.add(Math.floor(Math.random()*25));
  minesState={ bet, safe:0, bombs, over:false };

  const cont=document.getElementById("mines");
  cont.innerHTML="";
  const grid=document.createElement("div");
  grid.className="grid"; grid.style.gridTemplateColumns="repeat(5,70px)";
  for(let i=0;i<25;i++){
    const c=document.createElement("div"); c.className="cell";
    c.onclick=()=>{
      if(minesState.over) return;
      if(bombs.has(i)){
        bombs.forEach(b=>grid.children[b].classList.add("fail"));
        minesState.over=true;
        toast("You lost "+formatNum(bet));
      } else { c.classList.add("safe"); minesState.safe++; }
    };
    grid.appendChild(c);
  }
  cont.appendChild(grid);
}
function cashoutMines(){
  if(!minesState||minesState.over) return;
  const mult=1+minesState.safe*0.25;
  const win=Math.floor(minesState.bet*mult);
  balance+=win; updateBalance(); minesState.over=true;
  toast("Mines cashout "+formatNum(win));
}

/* ================= TOWER ================= */
let towerState=null;
function startTower(){
  const bet=+betInput.value;
  if(bet>balance) return; balance-=bet; updateBalance();
  const diff=towerDiff.value; let cols=3,fails=1,mult=1.3;
  if(diff==="medium"){ cols=2; mult=1.5 }
  if(diff==="hard"){ fails=2; mult=1.8 }
  towerState={ bet, level:0, mult, over:false };

  const cont=document.getElementById("tower"); cont.innerHTML="";
  const tower=document.createElement("div"); tower.className="tower";
  function addRow(){
    if(towerState.over||towerState.level>=6) return;
    const row=document.createElement("div"); row.className="row";
    const bad=new Set(); while(bad.size<fails) bad.add(Math.floor(Math.random()*cols));
    for(let i=0;i<cols;i++){
      const b=document.createElement("div"); b.className="block";
      b.onclick=()=>{
        if(towerState.over) return;
        if(bad.has(i)){ b.classList.add("fail"); towerState.over=true; toast("You lost "+formatNum(bet)); }
        else { b.classList.add("safe"); towerState.level++; addRow(); }
      };
      row.appendChild(b);
    }
    tower.appendChild(row);
  }
  addRow(); cont.appendChild(tower);
}
function cashoutTower(){
  if(!towerState||towerState.over) return;
  const win=Math.floor(towerState.bet*Math.pow(towerState.mult,towerState.level));
  balance+=win; updateBalance(); towerState.over=true;
  toast("Tower cashout "+formatNum(win));
}

/* ================= DRAW ================= */
let drawCards=[], drawPerTile=0;
function startDraw(){
  const bet=+betInput.value; if(bet>balance) return;
  balance-=bet; updateBalance(); drawPerTile=bet/9; drawCards=[];
  const cont=document.getElementById("draw"); cont.innerHTML="";
  const grid=document.createElement("div"); grid.className="grid"; grid.style.gridTemplateColumns="repeat(3,95px)";
  for(let i=0;i<9;i++){
    const card={ mult:1, alive:true, withdrawn:false }; drawCards.push(card);
    const c=document.createElement("div"); c.className="drawCell"; updateDrawCell(c,card);
    const w=document.createElement("button"); w.innerText="Withdraw"; w.onclick=()=>withdrawCard(card,c);
    c.appendChild(w); grid.appendChild(c);
  }
  cont.appendChild(grid);
}
function updateDrawCell(cell,card){
  const worth=Math.floor(drawPerTile*card.mult);
  cell.innerHTML=`<div><b>${card.mult}x</b></div><div class="small">Worth: ${formatNum(worth)}</div>`;
}
function doubleAllDraw(){
  drawCards.forEach((card,i)=>{
    if(!card.alive||card.withdrawn) return;
    const cell=document.querySelectorAll(".drawCell")[i];
    if(Math.random()<=0.45){
      card.mult*=2;
      if(card.mult>=64){ autoWithdraw(card,cell); }
      else { updateDrawCell(cell,card); cell.appendChild(makeWithdrawBtn(card,cell)); }
    } else { card.alive=false; cell.classList.add("fail"); cell.innerHTML="X"; }
  });
}
function makeWithdrawBtn(card,cell){ const w=document.createElement("button"); w.innerText="Withdraw"; w.onclick=()=>withdrawCard(card,cell); return w; }
function autoWithdraw(card,cell){
  const win=Math.floor(drawPerTile*card.mult); balance+=win; updateBalance();
  card.withdrawn=true; cell.classList.add("locked");
  cell.innerHTML=`<div><b>64x</b></div><div class="small">Auto Paid: ${formatNum(win)}</div>`;
  toast("Auto cashout "+formatNum(win)+" at 64x");
}
function withdrawCard(card,cell){
  if(!card.alive||card.withdrawn) return;
  const win=Math.floor(drawPerTile*card.mult); balance+=win; updateBalance();
  card.withdrawn=true; cell.classList.add("locked");
  cell.innerHTML=`<div><b>${card.mult}x</b></div><div class="small">Paid: ${formatNum(win)}</div>`;
}
function withdrawAllDraw(){ drawCards.forEach((card,i)=>{ if(card.alive&&!card.withdrawn) withdrawCard(card,document.querySelectorAll(".drawCell")[i]); }); }
</script>
</body>
</html>
